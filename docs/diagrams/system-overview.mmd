graph TB
    subgraph "External Services"
        TELEGRAM[Telegram API]
        LLM_GEMINI[Gemini Flash API]
        LLM_GPT[GPT-4o-mini API]
        USER[End Users]
    end

    subgraph "Traefik Reverse Proxy (Production)"
        TRAEFIK[Traefik<br/>SSL Termination<br/>Let's Encrypt]
    end

    subgraph "Frontend Layer"
        FRONTEND[Frontend<br/>React 18 + Vite<br/>Tailwind CSS<br/>Zustand + React Query<br/>PWA + i18n<br/>Port: 5173/80]
    end

    subgraph "Backend Layer"
        BACKEND[Backend API<br/>FastAPI + Uvicorn<br/>Python<br/>Port: 8000]
        SCHEDULER[Background Scheduler<br/>APScheduler<br/>Collection + Digests]
    end

    subgraph "Data Layer"
        POSTGRES[(PostgreSQL<br/>Primary Database<br/>Messages, Channels,<br/>Users, Collections,<br/>Audit Logs)]
        QDRANT[(Qdrant<br/>Vector Database<br/>Embeddings<br/>Deduplication)]
        REDIS[(Redis<br/>Cache Layer<br/>Translations<br/>Sessions)]
    end

    subgraph "Storage"
        TELEGRAM_VOL[Telegram Session Data]
    end

    %% User interactions
    USER -->|HTTPS| TRAEFIK
    TRAEFIK -->|Route: osfeed.com| FRONTEND
    TRAEFIK -->|Route: api.osfeed.com| BACKEND

    %% Frontend to Backend
    FRONTEND -->|REST API<br/>WebSocket| BACKEND

    %% Backend to Data Layer
    BACKEND -->|SQL Queries| POSTGRES
    BACKEND -->|Vector Search<br/>Store Embeddings| QDRANT
    BACKEND -->|Cache Read/Write<br/>Translation Results| REDIS

    %% Backend to External Services
    BACKEND -->|Collect Messages<br/>Flood-wait Handling| TELEGRAM
    BACKEND -->|Translation Requests<br/>Model Routing| LLM_GEMINI
    BACKEND -->|Translation Fallback| LLM_GPT

    %% Scheduler
    SCHEDULER -.->|Triggers| BACKEND
    BACKEND -.->|Scheduled Tasks<br/>Collections<br/>Digests| SCHEDULER

    %% Storage
    BACKEND -->|Session Files| TELEGRAM_VOL

    %% Styling
    classDef frontend fill:#61dafb,stroke:#333,stroke-width:2px,color:#000
    classDef backend fill:#009688,stroke:#333,stroke-width:2px,color:#fff
    classDef database fill:#336791,stroke:#333,stroke-width:2px,color:#fff
    classDef external fill:#ff9800,stroke:#333,stroke-width:2px,color:#000
    classDef proxy fill:#37b24d,stroke:#333,stroke-width:2px,color:#fff
    classDef storage fill:#9c27b0,stroke:#333,stroke-width:2px,color:#fff

    class FRONTEND frontend
    class BACKEND,SCHEDULER backend
    class POSTGRES,QDRANT,REDIS database
    class TELEGRAM,LLM_GEMINI,LLM_GPT,USER external
    class TRAEFIK proxy
    class TELEGRAM_VOL storage
